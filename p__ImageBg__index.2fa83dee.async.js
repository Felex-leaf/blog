"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[17],{8235:function(w,B,e){e.d(B,{Z:function(){return i}});var U=e(42122),f=e.n(U),D=e(70215),N=e.n(D),T=e(94184),m=e.n(T),v=e(67294),p={button:"button___wWSxm"},O=e(85893),E=["children","style","className","theme"];function P(g){var x=(0,v.useRef)(null),A=g.children,W=A===void 0?"\u786E\u8BA4":A,I=g.style,h=g.className,C=g.theme,Z=N()(g,E),R=f()({},I);return(0,v.useEffect)(function(){if(C){var y=x.current;y&&y.style.setProperty("--theme-color--",C)}},[C]),(0,O.jsx)("div",f()(f()({},Z),{},{className:m()([h,p.button]),style:R,ref:x,children:W}))}var i=(0,v.memo)(P)},17943:function(w,B,e){e.r(B),e.d(B,{default:function(){return A}});var U=e(17061),f=e.n(U),D=e(17156),N=e.n(D),T=e(27424),m=e.n(T),v=e(67294),p=e(80476),O=e(89325),E=e(24969),P=e(8235),i=e(85893),g;function x(){var W=(0,v.useState)(""),I=m()(W,2),h=I[0],C=I[1],Z=(0,v.useState)(40),R=m()(Z,2),y=R[0],M=R[1],k=(0,v.useState)("white"),J=m()(k,2),$=J[0],q=J[1],_=(0,v.useState)(!1),K=m()(_,2),L=K[0],F=K[1],Q=(0,v.useRef)(),tt=function(a,n){var t=document.createElement("canvas");return t.setAttribute("width",a==null?void 0:a.toString()),t.setAttribute("height",n==null?void 0:n.toString()),t.getContext("2d")},et=function(a){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=new Image;return a.startsWith("data")||(t.crossOrigin="Anonymous"),new Promise(function(r,l){t.onload=function(){var u=t.naturalWidth*n,d=t.naturalHeight*n,j=tt(u,d);j.drawImage(t,0,0,u,d);var s=j.getImageData(0,0,u,d),S=s.data;r({data:S,width:u,height:d})};var o=function(){return l(new Error("An error occurred attempting to load image"))};t.onerror=o,t.onabort=o,t.src=a})},H=function(a,n,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],l=a[n+3];if(l===0)return t;var o=Array.from(a.subarray(n,n+3));if(o.indexOf(void 0)!==-1)return t;var u=l&&l!==255?"rgba(".concat([].concat(o,[l]).join(","),")"):"rgb(".concat(o.join(","),")");return r.indexOf(u)!==-1||(t[u]?t[u].count+=1:t[u]={color:u,count:1}),t},V=function(a,n){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=0;r<a.length;r+=4)H(a,r,n,t);return n},at=function(a,n,t){for(var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:100,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],o={},u=a.slice(0,r*t*4),d=a.slice(((n-r)*t+1)*4),j=[],s=[],S=0;S<n-2*r;S+=1)for(var ut=r+S,Y=ut*t,b=0;b<2*r;b+=1)if(b<r){var G=(Y+b+1)*4;H(a.slice(G,G+3),0,o,l),j.push(G)}else{var z=(Y+b+t-r)*4;H(a.slice(z,z+3),0,o,l),s.push(z)}V(u,o,l),V(d,o,l);var st=Object.values(o);return st.sort(function(ot,lt){return lt.count-ot.count})},X=function(){var c=N()(f()().mark(function a(n){var t,r,l,o,u,d;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,n){s.next=3;break}return s.abrupt("return");case 3:return F(!0),s.next=6,et(n);case 6:if(r=s.sent,l=r.data,o=r.height,u=r.width,d=at(l,o,u,y),Q.current){s.next=13;break}return s.abrupt("return");case 13:q((t=d[0])===null||t===void 0?void 0:t.color);case 14:return s.prev=14,F(!1),s.finish(14);case 17:case"end":return s.stop()}},a,null,[[0,,14,17]])}));return function(n){return c.apply(this,arguments)}}(),nt=function(a){var n=URL.createObjectURL(new Blob([a]));return C(n),X(n),!1},rt=(0,i.jsxs)("div",{children:[(0,i.jsx)(E.Z,{}),(0,i.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return(0,v.useEffect)(function(){console.info("\u80CC\u666F\u8272".concat(L?"\u8BA1\u7B97\u4E2D...":"\u8C03\u6574\u6210\u529F"))},[L]),(0,i.jsxs)("div",{ref:Q,className:"image-bg",style:{backgroundColor:$},children:[(0,i.jsxs)("div",{className:"image-bg-control",children:[(0,i.jsx)(p.Z,{name:"avatar",listType:"picture-card",showUploadList:!1,beforeUpload:nt,accept:".jpg,.png",children:h?(0,i.jsx)("img",{src:h,alt:"avatar",style:{width:"100%"}}):rt}),(0,i.jsx)(O.Z,{max:100,value:y,onChange:function(a){M(a)}}),(0,i.jsx)(P.Z,{theme:$,className:"image-bg-btn",onClick:function(){g&&(clearTimeout(g),g=null),F(!0),g=setTimeout(function(){X(h)},200)},children:"\u8C03\u6574\u80CC\u666F\u8272"})]}),L&&(0,i.jsx)("span",{style:{color:$},className:"image-bg-loading",children:"\u80CC\u666F\u8272\u8BA1\u7B97\u4E2D..."})]})}var A=x}}]);
